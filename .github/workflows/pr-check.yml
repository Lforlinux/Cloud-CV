name: Pull Request Check

on:
  pull_request:
    branches: [ main, master ]

jobs:
  check:
    runs-on: ubuntu-latest
    name: Check Changes
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Check file changes
      run: |
        echo "ğŸ” Checking changed files..."
        echo "Changed files:"
        git diff --name-only HEAD~1 HEAD
        
    - name: Validate Terraform
      run: |
        if [ -d "infra/terraform" ]; then
          echo "ğŸ”§ Validating Terraform configuration..."
          cd infra/terraform
          terraform init -backend=false
          terraform validate
          echo "âœ… Terraform configuration is valid"
        else
          echo "âš ï¸ No Terraform configuration found"
        fi
        
    - name: Check frontend files
      run: |
        echo "ğŸ¨ Checking frontend files..."
        if [ -f "frontend/index.html" ]; then
          echo "âœ… index.html exists"
        else
          echo "âŒ index.html missing"
          exit 1
        fi
        
        if [ -f "frontend/styles.css" ]; then
          echo "âœ… styles.css exists"
        else
          echo "âŒ styles.css missing"
          exit 1
        fi
        
        if [ -f "frontend/script.js" ]; then
          echo "âœ… script.js exists"
        else
          echo "âŒ script.js missing"
          exit 1
        fi
        
    - name: Check deployment scripts
      run: |
        echo "ğŸš€ Checking deployment scripts..."
        if [ -f "scripts/aws-deploy.sh" ]; then
          echo "âœ… aws-deploy.sh exists"
        else
          echo "âŒ aws-deploy.sh missing"
          exit 1
        fi
        
    - name: Summary
      run: |
        echo "âœ… All checks passed!"
        echo "ğŸ¯ Ready for deployment!"
