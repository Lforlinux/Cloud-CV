name: Pull Request Check

on:
  pull_request:
    branches: [ main, master ]

jobs:
  check:
    runs-on: ubuntu-latest
    name: Check Changes
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Check file changes
      run: |
        echo "🔍 Checking changed files..."
        echo "Changed files:"
        git diff --name-only HEAD~1 HEAD
        
    - name: Validate Terraform
      run: |
        if [ -d "infra/terraform" ]; then
          echo "🔧 Validating Terraform configuration..."
          cd infra/terraform
          terraform init -backend=false
          terraform validate
          echo "✅ Terraform configuration is valid"
        else
          echo "⚠️ No Terraform configuration found"
        fi
        
    - name: Check frontend files
      run: |
        echo "🎨 Checking frontend files..."
        if [ -f "frontend/index.html" ]; then
          echo "✅ index.html exists"
        else
          echo "❌ index.html missing"
          exit 1
        fi
        
        if [ -f "frontend/styles.css" ]; then
          echo "✅ styles.css exists"
        else
          echo "❌ styles.css missing"
          exit 1
        fi
        
        if [ -f "frontend/script.js" ]; then
          echo "✅ script.js exists"
        else
          echo "❌ script.js missing"
          exit 1
        fi
        
    - name: Check deployment scripts
      run: |
        echo "🚀 Checking deployment scripts..."
        if [ -f "scripts/aws-deploy.sh" ]; then
          echo "✅ aws-deploy.sh exists"
        else
          echo "❌ aws-deploy.sh missing"
          exit 1
        fi
        
    - name: Summary
      run: |
        echo "✅ All checks passed!"
        echo "🎯 Ready for deployment!"
